#rabbitmq
old_sound_rabbit_mq:
    connections:
        default:
            host:     "%rabbitmq_host%"
            port:     "%rabbitmq_port%"
            user:     "%rabbitmq_user%"
            password: "%rabbitmq_password%"
            vhost:    "%rabbitmq_vhost%"
            lazy:     false
            connection_timeout: 3
            read_write_timeout: 3
            keepalive: true
            heartbeat: 0
            use_socket: false
    producers:
      task_command_runner:
          connection:       default
          exchange_options: {name: 'task_command_runner', type: direct}
      task_cache_recalculate:
          connection:       default
          exchange_options: {name: 'task_cache_recalculate', type: direct}
      async_search:
          connection:       default
          exchange_options: {name: 'async_search', type: direct}
      warm_up_search:
          connection:       default
          exchange_options: {name: 'warm_up_search', type: direct}
      cache_invalidate:
          connection:       default
          exchange_options: {name: 'cache_invalidate', type: direct}

    consumers:
      task_command_runner:
        connection:       default
        exchange_options: {name: 'task_command_runner', type: direct}
        queue_options:    {name: 'task_command_runner'}
        callback:         task_command_runner
        # idle_timeout:     10
      task_cache_recalculate:
              connection:       default
              exchange_options: {name: 'task_cache_recalculate', type: direct}
              queue_options:    {name: 'task_cache_recalculate'}
              callback:         task_command_runner
              # idle_timeout:     10
      async_search:
              connection:       default
              exchange_options: {name: 'async_search', type: direct}
              queue_options:    {name: 'async_search'}
              callback:         mbh_search.asycn_search
      warm_up_search:
          connection:       default
          exchange_options: {name: 'warm_up_search', type: direct}
          queue_options:    {name: 'warm_up_search'}
          callback:         mbh_search.warm_up_search
      cache_invalidate:
          connection:       default
          exchange_options: {name: 'cache_invalidate', type: direct}
          queue_options:    {name: 'cache_invalidate'}
          callback:         mbh_search.invalidate_consumer

    batch_consumers:
      batch_async_search:
        connection: default
        exchange_options: {name: 'async_search', type: direct}
        queue_options:    {name: 'async_search'}
        callback:         mbh_search.batch_asycn_search
        qos_options:      {prefetch_size: 0, prefetch_count: 100, global: false}
        timeout_wait:     5
        auto_setup_fabric: false
        idle_timeout_exit_code: -2
        keep_alive: false
        graceful_max_execution:
          timeout: 1800