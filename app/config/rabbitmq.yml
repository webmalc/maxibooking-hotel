#rabbitmq-supervisor
#rabbit_mq_supervisor:
#    commands:
#        rabbitmq_consumer: rabbitmq:consumer -m 1 %%2$s

#rabbitmq
old_sound_rabbit_mq:
    connections:
        default:
            host:     "%rabbitmq_host%"
            port:     "%rabbitmq_port%"
            user:     "%rabbitmq_user%"
            password: "%rabbitmq_password%"
            vhost:    "%rabbitmq_vhost%"
            lazy:     false
            connection_timeout: 3
            read_write_timeout: 3
            keepalive: false
            heartbeat: 0
            use_socket: false
    producers:
      task_room_cache_recalculate:
        connection:       default
        exchange_options: {name: 'task_room_cache_recalculate', type: direct}

      task_calculate_special_prices:
        connection: default
        exchange_options: {name: 'task_special_recalculate', type: direct}

      task_prepare_package_moving_report:
        connection:       default
        exchange_options: {name: 'task_prepare_package_moving_report', type: direct}

      task_cache_clear:
        connection: default
        exchange_options: {name: 'task_cache_clear', type: direct}

      async_search:
        connection:       default
        exchange_options: {name: 'async_search', type: direct}


      warm_up_search:
          connection:       default
          exchange_options: {name: 'warm_up_search', type: direct}
      cache_invalidate:
          connection:       default
          exchange_options: {name: 'cache_invalidate', type: direct}

    consumers:
      task_room_cache_recalculate:
        connection:       default
        exchange_options: {name: 'task_room_cache_recalculate', type: direct}
        queue_options:    {name: 'task_room_cache_recalculate'}
        callback:         task_room_cache_recalculate

      task_prepare_package_moving_report:
        connection:       default
        exchange_options: {name: 'task_prepare_package_moving_report', type: direct}
        queue_options:    {name: 'task_prepare_package_moving_report'}
        callback:         mbh.task_prepare_package_moving_report

      task_calculate_special_prices:
        connection:       default
        exchange_options: {name: 'task_special_recalculate', type: direct}
        queue_options:    {name: 'task_special_recalculate'}
        callback:         task_special_recalculate

      task_cache_clear:
        connection:       default
        exchange_options: {name: 'task_cache_clear', type: direct}
        queue_options:    {name: 'task_cache_clear'}
        callback:         task_cache_clear

      async_search:
        connection:       default
        exchange_options: {name: 'async_search', type: direct}
        queue_options:    {name: 'async_search'}
        callback:         mbh_search.asycn_search
        graceful_max_execution:
          timeout: 3600
          exit_code: 10



      warm_up_search:
          connection:       default
          exchange_options: {name: 'warm_up_search', type: direct}
          queue_options:    {name: 'warm_up_search'}
          callback:         mbh_search.warm_up_search

      cache_invalidate:
          connection:       default
          exchange_options: {name: 'cache_invalidate', type: direct}
          queue_options:    {name: 'cache_invalidate'}
          callback:         mbh_search.invalidate_consumer