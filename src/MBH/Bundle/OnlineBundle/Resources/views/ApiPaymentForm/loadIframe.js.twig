{% if constant('MBH\\Bundle\\ClientBundle\\Document\\PaymentSystem\\NewRbk::KEY') in paymentSystems %}
    {% include '@MBHClient/PaymentSystem/newRbk/script_for_online_form.js.twig' %}
{% endif %}

var mbhPaymentFunc = {
    frameId    : '{{ wrapperId }}-iframe',
    locale     : '{{ locale }}',
    getForm    : function(locale) {
        if (locale !== undefined) {
            this.locale = locale;
        }
        var formWrapper = document.querySelector('#{{ wrapperId }}');
        formWrapper.innerHTML = '';
        formWrapper.appendChild(this.getIframe());
    },
    generateUrl: function() {
        return '{{ url('online_payment_search_form', {formId: config.id}) | raw }}?locale=' + this.locale
    },
    getIframe: function() {
        var iframe = document.createElement('iframe');
        iframe.id = this.frameId;
        iframe.name = this.frameId;
        iframe.src = this.generateUrl();
        iframe.scrolling = 'no';
        iframe.frameBorder = 0;
        iframe.width = "{{ config.fullWidth ? '100%' : config.frameWidth }}";
        iframe.height = "{{ config.frameHeight }}";

        return iframe;
    }
};

window.addEventListener('load', function(ev) {
    mbhPaymentFunc.getForm();
});