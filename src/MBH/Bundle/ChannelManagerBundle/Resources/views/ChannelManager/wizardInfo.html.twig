{% extends 'MBHChannelManagerBundle:ChannelManager:layout.html.twig' %}

{% set layout = 'tabs' %}
{% set small_title = 'views.channnelmanager.settings'|trans({}, 'MBHChannelManagerBundle') %}
{% if config is not defined %}
    {% set config = null %}
{% endif %}

{% set isConnectionRequestSent = config and config.hotelId and config.id %}
{% if config is not defined %}
    {% set config = null %}
{% endif %}
{% set hasUnfilledData = notifications is defined and notifications is not empty %}

{% block content %}
    {% include 'MBHChannelManagerBundle::tabs.html.twig' with {'active': 0, 'base': 'booking'} %}

    <div class="tab-content">
        <div id="channel-manager-instruction" class="well">
            {% include '@MBHChannelManager/ChannelManager/cmConnectionInstructions.html.twig' with {channelManager: channelManagerName} %}
        </div>

        <div class="tab-pane active" id="home">
            {% if hasForm %}
                {% if config and config.hotelId and config.id %}
                    <div class="well" id="connection-request-sent-message">Заявка отправлена, ожидайте сообщения тех.
                        поддержки
                    </div>
                {% else %}
                    {{ form_start(form, {'attr': {'class': 'form-horizontal'}}) }}
                    {{ form_widget(form) }}
                    <div class="navbar">
                        <div class="container-fluid">
                            <ul class="nav navbar-nav">
                                <li>
                                    <button type="submit" name="save"
                                            class="btn btn-success navbar-btn" {{ hasUnfilledData ? 'disabled' }}><i
                                                class="fa fa-check-square-o"> </i> {{ 'Отправить заявку' }}
                                    </button>
                                </li>
                            </ul>
                        </div>
                    </div>
                    {{ form_end(form) }}
                {% endif %}
            {% endif %}

            {% embed '@MBHBase/Actions/base_list.html.twig' %}
                {% block left %}
                    {% if channelManagerName in ['booking', 'expedia', 'myallocator'] %}
                        {% include '@MBHChannelManager/ChannelManager/confirmCMButton.html.twig' %}
                    {% endif %}
                {% endblock %}
            {% endembed %}
        </div>
    </div>
{% endblock %}
