services:
    mbh.channelmanager:
        class: MBH\Bundle\ChannelManagerBundle\Services\ChannelManager
        arguments: ['@service_container']

    mbh.channelmanager.vashotel:
        class: MBH\Bundle\ChannelManagerBundle\Services\Vashotel
        arguments: ['@service_container']

    mbh.channelmanager.oktogo:
        class: MBH\Bundle\ChannelManagerBundle\Services\Oktogo
        arguments: ['@service_container']

    mbh.channelmanager.booking:
        class: MBH\Bundle\ChannelManagerBundle\Services\Booking
        arguments: ['@service_container']

    mbh.channelmanager.myallocator:
        class: MBH\Bundle\ChannelManagerBundle\Services\MyAllocator
        arguments: ['@service_container']

    mbh.channelmanager.ostrovok:
        class: MBH\Bundle\ChannelManagerBundle\Services\Ostrovok
        arguments: ['@service_container']

    mbh.channelmanager.hundred_one_hotels:
        class: MBH\Bundle\ChannelManagerBundle\Services\HundredOneHotels
        arguments: ['@service_container']

    mbh.channelmanager.hoh_order_info:
        class: MBH\Bundle\ChannelManagerBundle\Model\HundredOneHotels\OrderInfo
        arguments: ['@service_container']
        shared: false

    mbh.channelmanager.hoh_package_info:
        class: MBH\Bundle\ChannelManagerBundle\Model\HundredOneHotels\PackageInfo
        arguments: ['@service_container']
        shared: false

    mbh.channelmanager.hoh_request_formatter:
        class: MBH\Bundle\ChannelManagerBundle\Model\HundredOneHotels\HOHRequestFormatter

    mbh.channelmanager.expedia:
        class: MBH\Bundle\ChannelManagerBundle\Services\Expedia\Expedia
        arguments: ['@service_container']

    mbh.channelmanager.expedia_type:
        class: MBH\Bundle\ChannelManagerBundle\Form\ExpediaType

    mbh.channelmanager.expedia_request_formatter:
        class: MBH\Bundle\ChannelManagerBundle\Services\Expedia\ExpediaRequestFormatter
        arguments: ['%mbh.channelmanager.services%']

    mbh.channelmanager.expedia_request_data_formatter:
        class: MBH\Bundle\ChannelManagerBundle\Services\Expedia\ExpediaRequestDataFormatter
        arguments: ['@service_container']

    mbh.channelmanager.helper:
        class: MBH\Bundle\ChannelManagerBundle\Services\ChannelManagerHelper
        arguments: ['@mbh.notifier', '@translator', '@doctrine_mongodb.odm.document_manager']

    mbh.channelmanager.order_handler:
        class: MBH\Bundle\ChannelManagerBundle\Services\OrderHandler
        arguments: ['@doctrine_mongodb.odm.document_manager']

    mbh.channelmanager.expedia_response_handler:
        class: MBH\Bundle\ChannelManagerBundle\Services\Expedia\ExpediaResponseHandler
        arguments: ['@service_container']
        shared: false

    mbh.channelmanager.expedia_order_info:
        class: MBH\Bundle\ChannelManagerBundle\Services\Expedia\ExpediaOrderInfo
        arguments: ['@service_container']
        shared: false

    mbh.channelmanager.expedia_package_info:
        class: MBH\Bundle\ChannelManagerBundle\Services\Expedia\ExpediaPackageInfo
        arguments: ['@service_container']
        shared: false

    mbh.channel_manager.order_handler:
        class: MBH\Bundle\ChannelManagerBundle\Services\OrderHandler
        arguments: ['@doctrine.odm.mongodb.document_manager', '@mbh.package.search', '@translator', '@validator']


    mbh.channel_manager.expedia_notification_order_info:
        class: MBH\Bundle\ChannelManagerBundle\Services\Expedia\ExpediaNotificationOrderInfo
        arguments: ['@service_container']

    mbh.channel_manager.expedia_notification_package_info:
        class: MBH\Bundle\ChannelManagerBundle\Services\Expedia\ExpediaNotificationPackageInfo
        arguments: ['@service_container']

    mbh.channel_manager.expedia_notification_response_compiler:
        class: MBH\Bundle\ChannelManagerBundle\Services\Expedia\ExpediaNotificationResponseCompiler

    mbh.channelmanager.booking_type:
      class: MBH\Bundle\ChannelManagerBundle\Form\BookingType
      arguments: ['@mbh.currency']
      tags:
              - { name: form.type }

    mbh.channelmanager.myallocator_type:
      class: MBH\Bundle\ChannelManagerBundle\Form\MyallocatorType
      arguments: ['@mbh.channelmanager.myallocator', '@mbh.currency']
      tags:
              - { name: form.type }

    mbh.channelmanager.logger:
        class:     Symfony\Bridge\Monolog\Logger
        arguments: [app]
        calls:
            - [pushHandler, ['@mbh.channelmanager.logger_handler']]

    mbh.channelmanager.logger_handler:
        class:     Monolog\Handler\StreamHandler
        arguments: ['%kernel.logs_dir%/%kernel.environment%.channelmanager.log', 200]

    mbh.channelmanager.configs.subscriber:
            class: MBH\Bundle\ChannelManagerBundle\EventListener\ConfigsSubscriber
            arguments: ['@service_container']
            tags:
                - { name: doctrine_mongodb.odm.event_subscriber, connection: default}

    ostrovok_api_service:
        class: MBH\Bundle\ChannelManagerBundle\Lib\Ostrovok\OstrovokApiService
        arguments: ['%mbh.channelmanager.services%']

    mbh_bundle_channel_manager.lib_ostrovok.ostrovok_data_generator:
        class: MBH\Bundle\ChannelManagerBundle\Lib\Ostrovok\OstrovokDataGenerator

    mbh.channel_manager.tripadvisor:
        class: MBH\Bundle\ChannelManagerBundle\Services\TripAdvisor\TripAdvisorHelper
        arguments:
              - '@mbh.package.search'
              - '@translator'
              - '@validator'
              - '@mbh.channel_manager.trip_advisor_response_compiler'
              - '%mbhs_key%'
              - '@doctrine.odm.mongodb.document_manager'

    mbh.channel_manager.trip_advisor_response_compiler:
      class: MBH\Bundle\ChannelManagerBundle\Services\TripAdvisor\TripAdvisorResponseCompiler
      arguments: ['%trip_advisor_confirmation_url%', '%router.request_context.host%', '%online_form_result_url%', '%locale%', '@doctrine_mongodb.odm.document_manager', '@vich_uploader.templating.helper.uploader_helper', '@mbh.currency', '@mbh.channel_manager.order_handler']

    mbh.channel_manager.trip_advisor_response_data_formatter:
      class: MBH\Bundle\ChannelManagerBundle\Services\TripAdvisor\TripAdvisorDataFormatter
      arguments: ['@mbh.package.search', '@doctrine.odm.mongodb.document_manager']

    mbh.channel_manager.trip_advisor_order_info:
      class: MBH\Bundle\ChannelManagerBundle\Services\TripAdvisor\TripAdvisorOrderInfo
      arguments: ['@service_container']
      shared: false

    mbh.channel_manager.trip_advisor_package_info:
      class: MBH\Bundle\ChannelManagerBundle\Services\TripAdvisor\TripAdvisorPackageInfo
      arguments: ['@service_container']
      shared: false

    mbh.channel_manager.trip_advisor.tariff_type:
      class: MBH\Bundle\ChannelManagerBundle\Form\TripAdvisor\TripAdvisorTariffType
      arguments: ['@doctrine.odm.mongodb.document_manager']
      tags:
          - { name: form.type }

    mbh.channel_manager.trip_advisor.tariffs_type:
      class: MBH\Bundle\ChannelManagerBundle\Form\TripAdvisor\TripAdvisorTariffsType
      tags:
          - { name: form.type }

    mbh.channelmanager.ostrovok.api_service:
        class: MBH\Bundle\ChannelManagerBundle\Lib\Ostrovok\OstrovokApiService
        arguments: ['%mbh.channelmanager.services%']

    mbh.channelmanager.ostrovok.data_generator:
        class: MBH\Bundle\ChannelManagerBundle\Lib\Ostrovok\OstrovokDataGenerator

    mbh.twig.channelmanager.extension:
        class: MBH\Bundle\ChannelManagerBundle\Twig\Extension
        arguments: ['@service_container', '@doctrine_mongodb', '%mbh.channelmanager.services%']
        tags:
            - { name: twig.extension }


    mbh.channelmanager.trip_advisor_fee_type:
        class: MBH\Bundle\ChannelManagerBundle\Form\TripAdvisor\TripAdvisorFeeType
        arguments: ['@mbh.currency']
        tags:
            - { name: form.type }

    mbh.channel_manager.trip_advisor_validator:
        class: MBH\Bundle\ChannelManagerBundle\Validator\Constraints\TripAdvisorValidator
        arguments: ['@translator', '%trip_advisor_confirmation_url%', '@mbh.channel_manager.tripadvisor']
        tags:
            - { name: validator.constraint_validator }

    mbh.tripadvisor_type:
        class: MBH\Bundle\ChannelManagerBundle\Form\TripAdvisor\TripAdvisorType
        arguments: ['%mbh.pariking_types%']
        tags:
            - {name: form.type}